# Use Red Hat Universal Base Image
FROM registry.access.redhat.com/ubi8/openjdk-16:latest

# Set maintainer information (optional)
LABEL maintainer="vibish@gmail.com"

# Update system and install required packages
RUN yum update -y && \
    yum install -y iputils bind-utils procps-ng net-tools git java-17-openjdk-devel wget && \
    yum clean all

# Set environment variables for Tomcat
ENV CATALINA_HOME=/usr/local/tomcat
ENV PATH=$CATALINA_HOME/bin:$PATH
ENV CATALINA_OPTS=""

# Download and extract Tomcat
RUN wget https://downloads.apache.org/tomcat/tomcat-11/v11.0.1/bin/apache-tomcat-11.0.1.tar.gz -O /tmp/tomcat.tar.gz && \
    mkdir -p $CATALINA_HOME && \
    tar -xzf /tmp/tomcat.tar.gz --strip-components=1 -C $CATALINA_HOME && \
    rm -f /tmp/tomcat.tar.gz

# Create a custom index.html file
RUN echo "Hi this is from container" > $CATALINA_HOME/webapps/ROOT/index.html

# Expose default Tomcat port
EXPOSE 8080

# Default command to start Tomcat
CMD ["catalina.sh", "run"]